/* domino.js - a JS fast dashboard prototyping framework - Version: 1.2.4 - Author:  Alexis Jacomy, Linkfluence - License: MIT */
(function(l){function ja(){L.strict?E.apply(this,arguments):pa.apply(this,arguments)}function E(){var a="",l;for(l in arguments)a+=(a?" ":"")+arguments[l];throw Error(a);}function pa(){L.verbose&&qa.apply(this,arguments)}function qa(){var a=[],l;for(l in arguments)a.push(arguments[l]);L.displayTime&&a.unshift(("00000000"+((new Date).getTime()-ra)).substr(-8));console&&console.log instanceof Function&&console.log.apply(console,a)}var xa=/^[a-zA-Z_$-][a-zA-Z_$0-9-]*$/,ra=new Date,da={};if(this.domino)throw Error("domino already exists");
var D=this.domino=function(a,t){function g(b){b=b||{};var e={getEvents:ca,getLabel:ba,expand:Z,warn:y,log:F,die:u,get:ka};b.full?(e.help=ea,e.kill=pa,e.update=w,e.request=A,e.settings=B,e.modules=d,e.addModule=h,e.killModule=c,e.getEvent=function(){C.getEvent.apply(C,arguments)},e.addEventListener=function(){C.addEventListener.apply(C,arguments)},e.removeEventListener=function(){C.removeEventListener.apply(C,arguments)},e.configuration=ja,e.dispatchEvent=function(b,e){Q({events:C.getEvent(b,e)});
return this}):(b.request&&(Object.defineProperty(e,"_services",{value:[]}),e.request=function(b,e){var f,a;if(n.check("string",b)){a={service:b};for(f in e||{})a[f]=e[f];this._services.push(a)}else if(n.check("object",b))this._services.push(b);else if(n.check("array",b))for(f in b)this._services.push(b[f]);return this}),b.dispatchEvent&&(Object.defineProperty(e,"_events",{value:[]}),e.dispatchEvent=function(b,e){this._events.push(C.getEvent(b,e));return this}),b.update&&(Object.defineProperty(e,"_properties",
{value:[]}),e.update=function(b,e){if("object"===typeof b)for(var f in b)this._properties.push({property:f,value:b[f]});else"string"===typeof b&&1<arguments.length&&this._properties.push({property:b,value:e});return this}));return e}function r(b){b.request!==l&&(b.request=function(){u("This method is no longer available.");return this});b.dispatchEvent!==l&&(b.dispatchEvent=function(){u("This method is no longer available.");return this})}function m(b,e){var p,v,f=e||{};b===l&&u("Property name not specified");
"string"!==n.get(b)&&u("The property name must be a string");R[b]!==l&&u('Property "'+b+'" already exists');la[b]!==l&&u('"'+b+'" can not be used to name a property');b.match(xa)||u("Property name not valid ("+xa+")");sa[b]={};for(v in f)sa[b][v]=f[v];ta[b]=f.label||b;f.description&&(M.properties[f.id]=f.description);f.type!==l&&(n.isValid(f.type)?V[b]=f.type:y('Property "'+b+'": Type not valid'));f.setter!==l&&("function"!==n.get(f.setter)?y('Property "'+b+'": Setter is not a function'):(H[b]=f.setter,
ua[b]=!0));H[b]=H[b]||function(e){if(n.deepScalar(V[b])&&n.compare(e,R[b],V[b]))return!1;V[b]&&!n.check(V[b],e)?y('Property "'+b+'": Wrong type error'):R[b]=e;return!0};f.getter!==l&&("function"!==n.get(f.getter)?y('Property "'+b+'": Getter is not a function'):(I[b]=f.getter,va[b]=!0));I[b]=I[b]||function(){return R[b]};if(f.value!==l||V[b])f.value!==l?ya(b,f.value):F('Property "'+b+'": Initial value is missing');if(f.triggers!==l)for(p in!n.check("array|string",f.triggers)&&y('Property "'+b+'": Events ("triggers") must be specified in an array or separated by spaces in a string'),
W[b]=z.array(f.triggers),W[b]||[])X[W[b][p]]=X[W[b][p]]||[],X[W[b][p]].push(b);f.dispatch!==l&&(n.check("array|string",f.dispatch)?fa[b]=z.array(f.dispatch):y('Property "'+b+'": Events ("dispatch") must be specified in an array or separated by spaces in a string'));return C}function q(b){var e=b||{};e.id!==l&&"string"===n.get(e.id)||u("The service id is not indicated.");n.check("function|string",e.url)||u("The service URL is not valid.");$[e.id]!==l&&u('The service "'+e.id+'" already exists.');e.description&&
(M.services[e.id]=e.description);$[e.id]=function(b){F('Calling service "'+e.id+'".');var v=b||{},f=v.shortcuts||{},a={contentType:v.contentType||e.contentType,dataType:v.dataType||e.dataType,type:(v.type||e.type||"GET").toString().toUpperCase(),data:v.data!==l?v.data:"function"===n.get(e.data)?e.data.call(g(),v):e.data,url:"function"===n.get(e.url)?e.url.call(g(),v):e.url,error:function(b,p){C.dispatchEvent("domino.ajaxFailed");var a=v.error||e.error;F('Loading service "'+e.id+'" failed with message "'+
b+'" and status '+p.status+".");"function"===n.get(a)&&N(a,{parameters:[b,p,v],loop:v.loop||Q,scope:{request:!0,dispatchEvent:!0,update:!0}})}},k,d,c;d=B("shortcutPrefix");b=RegExp(d+"(\\w+)","g");var h=RegExp("^"+d+"(\\w+)$"),x=null,w;for("string"!==n.get(a.url)&&u('The URL is no more a string (typed "'+n.get(a.url)+'")');(w=a.url.match(b))&&a.url!==x;)for(k in x=a.url,w)d=Z(w[k].match(h)[1],f),a.url=a.url.replace(RegExp(w[k],"g"),d);k=!0;"string"===n.get(a.data)&&a.data.match(h)&&(a.data=Z(a.data.match(h)[1],
f));if("object"===n.get(a.data))for(;k;)for(c in k=!1,a.data)"string"===n.get(a.data[c])&&a.data[c].match(h)&&(a.data[c]=Z(a.data[c].match(h)[1],f),k=!0);a.success=function(b,p){var k,d,ma,x,w={},t=[],m=[],u={},q=!1,s=v.path||e.path,m=v.setter||e.setter,A=v.success||e.success;x=v.expect||e.expect||B("expect");if("function"!==n.get(x)||x.call(g(),b,v,e)){F('Service "'+e.id+'" successfull.');"string"===n.get(m)&&m.match(h)&&(m=Z(m.match(h)[1],f));"string"===n.get(s)&&s.match(h)&&(s=Z(s.match(h)[1],
f));x=b;(s||"").match(/^(?:\w+\.)*\w+$/)?d=n.get(s,"string")?s.split("."):l:"string"===n.get(s)&&y('Path "'+s+'" does not match RegExp /^(?:\\w+\\.)*\\w+$/');if(d)for(k in d)x=x[d[k]],x===l&&y('Wrong path "'+s+'" for service "'+e.id+'".');d=z.array(e.events);for(k in d)w[d[k]]=1,q=!0;d=z.array(v.events);for(k in d)w[d[k]]=1,q=!0;m&&H[m]&&x!==l&&(u[m]=x,q=!0);if("function"===n.get(A)){k=N(A,{parameters:[b,v],scope:{request:!0,dispatchEvent:!0,update:!0}});d=z.array(k.events);for(c in d)q=!0,w[d[c].type]=
d[c];for(c in k.update)u[c]===l?(u[c]=k.update[c],q=!0):y('The key "'+c+'" is nor a method neither a property.');(k.services||[]).length&&(q=!0,t=t.concat(k.services));r(k)}m=[];for(ma in w)m.push(1===w[ma]?C.getEvent(ma):w[ma]);q&&(v.loop||Q)({events:m,update:u,services:t})}else F('"expect" test failed for service "'+e.id+'".'),a.error.call(this,"Unexpected data received.",p)};k=v.before||e.before;null!=k&&"function"===n.get(k)&&N(k,{parameters:[v],loop:!0,scope:{dispatchEvent:!0,update:!0}});v.abort&&
na[e.id]&&na[e.id].abort();na[e.id]=z.ajax(a)};return C}function h(b,e,p){var a;p=p||{};var f={},d={},k,c;b===l&&u("Module class not specified.");"function"!==n.get(b)&&u("First parameter must be a function.");"id"in p&&p.id in Y&&u('The module with id "'+p.id+'" already exists.');b.apply(f,(e||[]).concat(g()));b=f.triggers||{};for(c in b.events||{})S[c]=S[c]||[],S[c].push(b.events[c]);for(k in b.properties||{}){for(a in fa[k]||[])T[k]=T[k]||[],T[k].push(b.properties[k]);I[k]!==l&&(ka(k),N(b.properties[k],
{parameters:[g()]}))}for(c in X||{})d[c]=1;for(c in J||{})d[c]=1;for(c in O||{})d[c]=1;for(c in P||{})d[c]=1;for(c in d)f.addEventListener(c,x);"id"in p&&(Y[p.id]=f);U.push(f);return f}function d(b){return Y[b]}function c(b){var e,p,a,f,d,k,c,l,h={};n.check("string",b)&&(b=Y[b]);if(0>U.indexOf(b))return C.warn("The module you try to kill is actually not referenced."),b;l=b.triggers||{};for(k in l.events){f=S[k];d=l.events[k];if(f&&f.length)for(e=0,p=f.length;e<p;e++)f[e]===d&&f.splice(e,1);f&&!f.length&&
delete S[k]}for(c in l.properties){f=T[c];d=l.properties[c];if(f&&f.length)for(e=0,p=f.length;e<p;e++)f[e]===d&&f.splice(e,1);f&&!f.length&&delete T[c]}for(k in X||{})h[k]=1;for(k in J||{})h[k]=1;for(k in O||{})h[k]=1;for(k in P||{})h[k]=1;for(k in h)b.removeEventListener(k,x);U.splice(U.indexOf(b),1);for(a in Y)if(Y[a]===b){delete Y[a];break}return b}function w(b,e){var p="object"===typeof b&&1===arguments.length?b||{}:{};"string"===typeof b&&(p[b]=e);Q({update:p});return this}function x(b){Q({events:[b],
emitter:b.target})}function Q(b){var e,p,a,f,d,k,c,h=!1,x=[],w=[],m=[];b=b||{};var n={},t={};b.loop=(+b.loop||0)+1;b.loopId=b.loopId||++ra;B("maxDepth")&&b.loop>B("maxDepth")&&u("Loop "+b.loopId+" exceeds maximum depth ("+B("maxDepth")+")");var s=z.array(b.events);c=z.array(b.services);var q=b.update||{};if(B("verbose")){F("Iteration "+b.loop+" (loop "+b.loopId+")");if(s.length){d=[];for(p in s)d.push(s[p].type);F(" -> Events: ",d)}if(c.length){d=[];for(p in c)d.push("string"===typeof c[p]?c[p]:c[p].service);
F(" -> Services: ",d)}d=[];for(p in q)d.push(p);d.length&&F(" -> Update: ",d)}for(e in q)if(H[e]===l)y('The property "'+e+'" is not referenced.');else if(d=ya(e,q[e])||b.force||ga(e,"force")){for(p in T[e])N(T[e][p],{parameters:[g(),{property:e,emitter:b.emitter}]});for(p in fa[e]||[])d=fa[e][p],n[d]=C.getEvent(d)}if(c.length)if(B("mergeRequests"))A(c);else for(a in c)A(c[a]);for(p in s){k=s[p];c=k.data||{};e=X[k.type]||[];for(a in e)c[e[a]]!==l&&(h=!0,t[e[a]]=c[e[a]]);for(f in S[k.type])N(S[k.type][f],
{parameters:[g(),k,b.emitter]});for(a in J[k.type]||[])if(0>x.indexOf(J[k.type][a])){x.push(J[k.type][a]);c=N(J[k.type][a],{parameters:[k],scope:{request:!0,dispatchEvent:!0,update:!0}});e=z.array(c.events);for(f in e)n[e[f].type]=e[f];for(f in c.update)t[f]===l?(h=!0,t[f]=c.update[f]):y('The property "'+f+'" has already been updated in the current loop.');(c.services||[]).length&&(h=!0,m=m.concat(c.services));r(c)}for(a in O[k.type]||[])d=O[k.type][a],n[d]=C.getEvent(d);if(B("logDescriptions"))for(a in P[k.type]||
[])F("[HACK]",P[k.type][a])}for(k in n)C.dispatchEvent(k,n[k].data),w.push(n[k]),h=!0;h&&Q({events:w,update:t,services:m,emitter:b.emitter,loopId:b.loopId,loop:b.loop})}function ka(b){if(I[b]){if(va[b]){for(var e=[],a={},d=1,f=arguments.length;d<f;d++)e.push(arguments[d]);a[b]=R[b];e=N(I[b],{parameters:e,inputValues:a});return ga(b,"clone")?z.clone(e.returned):e.returned}return ga(b,"clone")?z.clone(I[b]()):I[b]()}y('Property "'+b+'" not referenced.')}function ya(b,e){if(H[b]){if(ua[b]){var a,d;a=
[];d={};ga(b,"clone")&&(e=z.clone(e));d[b]=ka(b);for(var f=1,c=arguments.length;f<c;f++)a.push(arguments[f]);d=N(H[b],{parameters:a,inputValues:d});(a="boolean"!==n.get(d.returned)||d.returned)&&(R[b]=d.update[b]);return a}return H[b].call(g(),ga(b,"clone")?z.clone(e):e)}y('Property "'+b+'" not referenced.');return!1}function A(b,e){if(n.check("string",b))if($[b])$[b](e);else y('Service "'+b+'" not referenced.');else if(n.check("object",b))A(b.service,b);else if(n.check("array",b)){e=e||{};var a,
d=b.length;if(e.merge!==l?e.merge:B("mergeRequests")){var f,c,k=d,h=[];for(a=0;a<d;a++){if("string"===typeof b[a])f={service:b[a]};else for(c in f={},b[a])f[c]=b[a][c];(function(b){f.loop=function(e){h[b]=e;if(!--k){var a,f,p={update:{},events:[],services:[]};for(a=0;a<d;a++){e=h[a]||{};for(f in e.update||{})p.update[f]=e.update[f];p.events=p.events.concat(e.events||[]);p.services=p.services.concat(e.services||[])}Q(p)}}})(a);A(f)}}else for(a=0,d=b.length;a<d;a++)A(b[a])}return this}function N(b,
e){var a,d,f={},c=e||{},k=g(c.scope);"function"!==n.get(b)&&u("The first parameter must be a function");for(a in c.inputValues||{})k[a]=c.inputValues[a];d={returned:b.apply(k,c.parameters||[]),update:{},events:[],services:[]};null==k._events||n.check("array",k._events)?d.events=k._events:y("Events must be stored in an array.");for(a in k)f[a]=k[a];for(a in k._properties)f[k._properties[a].property]=k._properties[a].value;for(a in f)H[a]!==l?d.update[a]=f[a]:la[a]===l&&y('The key "'+a+'" is not a method nor a property.');
for(a in c.inputValues)d.update[a]=k[a];for(a in k._services)d.services[a]=k._services[a];if(c.loop){f=(d.services||[]).length||(d.events||[]).length;if(!f)for(a in d.update)f=!0;f&&(n.check("function",c.loop)?c.loop:Q)(d)}else return d}function ba(b){return ta[b]}function ca(b){return W[b]}function Z(b){var a=b,d=(b||"").toString().match(RegExp("^"+B("shortcutPrefix")+"(\\w+)$"));d&&d.length&&(y("Prefix in expand() calls is deprecated."),a=d[1]);for(var d=1,c=arguments.length;d<c;d++)if((arguments[d]||
{})[a]!==l)return arguments[d][a];if("function"===n.get(I[a]))return ka(a);if("function"===n.get(aa[a]))return aa[a].call(g());y('The shortcut "',a,'" has not been recognized.');return a}function ga(b,a){var d=(sa[b]||{})[a];return d!==l?!!d:B(a)}function ja(b){return arguments.length?z.clone(wa[b]):z.clone(wa)}function ea(b,a,d){var c,f={};switch(b){case "properties":if(1===arguments.length){for(c in R)f[c]=M.properties[c]||"[no description is specified]";return f}return M.properties[a]||"[no description is specified]";
case "services":if(1===arguments.length){for(c in $)f[c]=M.services[c]||"[no description is specified]";return f}return M.services[a]||"[no description is specified]";case "shortcuts":if(1===arguments.length){for(c in aa)f[c]=M.shortcuts[c]||"[no description is specified]";return f}return M.shortcuts[a]||"[no description is specified]";case "hacks":if(1===arguments.length)return za;if(3===arguments.length)return f=[],"trigger"===a?f=P[d]:"dispatch"===a&&(f=ha[d]),1===f.length?f[0]:f;case "full":return{properties:ea("properties"),
shortcuts:ea("shortcuts"),services:ea("services"),hacks:ea("hacks")}}}function pa(){var b;F('Killing instance "'+G+'"');for(b in U)U[b].removeEventListener();aa=na=$=O=J=T=S=fa=X=U=ua=va=R=H=I=W=ta=V=U=null;for(b in ia)delete ia[b];da[G]&&delete da[G]}function B(b,a){if("string"===typeof b&&1===arguments.length)return oa[b]!==l?oa[b]:L[b];var d="object"===typeof b&&1===arguments.length?b||{}:{};"string"===typeof b&&(d[b]=a);for(var c in d)d[c]!==l?oa[c]=d[c]:delete oa[c];return this}function y(){var b=
["["+(G||"domino")+"]"];B("strict")||b.push("WARNING");for(var a in arguments)b.push(arguments[a]);B("strict")?E.apply(this,b):B("verbose")&&qa.apply(this,b)}function u(){var b=["["+(G||"domino")+"]"],a;for(a in arguments)b.push(arguments[a]);E.apply(this,b)}function F(){var b=["["+(G||"domino")+"]"];if(B("verbose")){for(var a in arguments)b.push(arguments[a]);qa.apply(this,b)}}(function(){K.call(this);for(var b in K.prototype)this[b]=K.prototype[b]}).call(this);var C=this,z=D.utils,n=D.struct,oa=
{},ia,wa,V={},ta={},W={},I={},H={},R={},sa={},va={},ua={},U=[],Y={},M={properties:{},shortcuts:{},services:{}},ra=0,X={},fa={},S={},T={},J={},O={},za=[],P={},ha={},$={},na={},aa={},la={events:1,services:1,hacks:1};(function(){for(var b in Object.prototype)la[b]=1;for(b in g({full:!0}))la[b]=1})();ia=g({full:!0});var s={},G;"string"===n.get(a)?(s=t,s.name=a):a!==l&&"object"===n.get(a)?s=a:t!==l&&"object"===n.get(t)&&(s=t);s.name=G||s.name;(G=s.name)&&(da[G]?u('An instance named "'+G+'" is already running.'):
da[G]=ia);(function(){for(var b in s.properties||[])m(s.properties[b].id,s.properties[b]);for(b in s.hacks||[]){var a=void 0,d=void 0,c=s.hacks[b]||{};c.triggers===l&&u("A hack requires at least one trigger to be bound");c.description&&za.push(c.description);a=z.array(c.triggers);for(d in a)P[a[d]]=P[a[d]]||[],O[a[d]]=O[a[d]]||[],J[a[d]]=J[a[d]]||[],c.description&&(P[a[d]]=P[a[d]].concat(c.description)),c.method&&J[a[d]].push(c.method),c.dispatch&&(O[a[d]]=O[a[d]].concat(z.array(c.dispatch)));a=z.array(c.dispatch);
for(d in a)ha[a[d]]=ha[a[d]]||[],c.description&&(ha[a[d]]=ha[a[d]].concat(c.description))}for(b in s.services||[])q(s.services[b]);for(b in s.shortcuts||[])a=s.shortcuts[b]||{},d=a.id,c=a.method,d===l&&u("Shortcut ID not specified."),aa[d]&&u('Shortcut "'+d+'" already exists.'),c===l&&u("Shortcut method not specified."),a.description&&(M.shortcuts[d]=a.description),aa[d]=c})();wa=z.clone(s);return ia};D.utils={array:function(a,l){var g="string"===D.struct.get(a)?a.split(l||" "):"array"===D.struct.get(a)?
a:[a],r=[],m;for(m in g)g[m]&&r.push(g[m]);return r},clone:function(a){if(!a)return a;var l,g;if("array"===ba.get(a))for(g in l=[],a)l[g]=this.clone(a[g]);else if("date"===ba.get(a))l=new Date(a.getTime());else if("object"===ba.get(a))if(a.prototype)l=a;else{l={};for(var r in a)l[r]=this.clone(a[r])}else l=a;return l},ajax:function(a,l){L.xhr||E('[domino.global] XMLHttpRequest not found. You can specify which XMLHttpRequest you want to use by using domino.settings("xhr", myXhr).');"string"===typeof a?
a={url:a,ok:l}:"object"!==ba.get(a)&&E("[domino.global] Invalid parameter given to AJAX");var g=a.type||"GET",r=a.url||"",m=a.contentType||"application/x-www-form-urlencoded",q=a.dataType||"json",h=new L.xhr,d,c,w;if(a.data){if("string"===typeof a.data)c=a.data;else if(/json/.test(m))c=JSON.stringify(a.data);else{c=[];for(w in a.data)c.push(encodeURIComponent(w)+"="+encodeURIComponent(a.data[w]));c=c.join("&")}/GET|DEL/i.test(g)&&(r+=/\?/.test(r)?"&"+c:"?"+c,c="")}h.onreadystatechange=function(){if(4==
h.readyState)if(d&&clearTimeout(d),/^2/.test(h.status)){c=h.responseText;if(/json/.test(q))try{c=JSON.parse(h.responseText)}catch(l){return a.error&&a.error("JSON parse error: "+l.message,h)}a.success&&a.success(c,h)}else{var w=+h.status?h.responseText:h.responseText.length?"Aborted: "+h.responseText:"Aborted";a.error&&a.error(w,h)}};h.open(g,r,!0);h.setRequestHeader("Content-Type",m);if(a.headers)for(w in a.headers)h.setRequestHeader(w,a.headers[w]);a.timeout&&(d=setTimeout(function(){h.onreadystatechange=
function(){};h.abort();a.error&&a.error&&a.error("timeout",h)},1E3*a.timeout));h.send(c);return h}};D.struct=function(){var a=["number","string","boolean","null","undefined"],t="Boolean Number String Function Array Date RegExp Object".split(" "),g={},r=["*"],m={},q;for(q in t){var h=t[q];r.push(h.toLowerCase());g["[object "+h+"]"]=h.toLowerCase()}return{add:function(a,c){var h,x,g,t,q,A;1===arguments.length?"object"===this.get(a)?(A=a,g=A.id,q=A.struct):E("[domino.global] If struct.add is called with one arguments, it has to be an object"):
2===arguments.length?("string"===this.get(a)&&a?g=a:E("[domino.global] If struct.add is called with more than one arguments, the first one must be the string id"),q=c):E("[domino.global] struct.add has to be called with one or three arguments");"string"===this.get(g)&&0!==g.length||E("[domino.global] A structure requires an string id");m[g]!==l&&"proto"!==m[g]&&E('[domino.global] The structure "'+g+'" already exists');m[g]=1;x=D.utils.array((A||{}).proto);t={};for(h in x)m[x[h]]===l&&(m[x[h]]=1,t[x[h]]=
1);"function"===this.get(q)||this.isValid(q)||E('[domino.global] A structure requires a valid "structure" property describing the structure. It can be a valid structure or a function that test if an object matches the structure.');~r.indexOf(g)&&E('[domino.global] "'+g+'" is a reserved structure name');m[g]=A===l?{id:g,struct:q}:{};if(A!==l)for(h in A)m[g][h]=A[h];for(h in t)h!==g&&delete m[h]},get:function(a){return null==a?String(a):g[Object.prototype.toString.call(a)]||"object"},check:function(a,
c,h){var g,q,t=this.get(c);h=h||{};if("string"===this.get(a)){g=a.replace(/^\?/,"").split(/\|/);for(q in g)if(0>r.indexOf(g[q])&&m[g[q]]===l)return ja("[domino.global] Invalid type"),!1;if(null==c)return!!a.match(/^\?/,"");a.replace(/^\?/,"");for(q in g)if(m[g[q]]&&("function"===this.get(m[g[q]].struct)?!0===m[g[q]].struct(c):this.check(m[g[q]].struct,c,m[g[q]])))return!0;return!(!~g.indexOf("*")&&!~g.indexOf(t))}if("object"===this.get(a)){if("object"!==t)return!1;for(g in a)if(!this.check(a[g],c[g]))return!1;
if(!h.includes)for(g in c)if(a[g]===l)return!1;return!0}if("array"===this.get(a)){if("array"!==t)return!1;if(1!==a.length)return ja("[domino.global] Invalid type"),!1;for(g in c)if(!this.check(a[0],c[g]))return!1;return!0}return!1},deepScalar:function(d){var c;if("string"===this.get(d)){d=d.replace(/^\?/,"").split(/\|/);for(c in d)if(0>a.indexOf(d[c]))return!1;return!0}if(this.check("object|array",d)){for(c in d)if(!this.deepScalar(d[c]))return!1;return!0}return!1},compare:function(a,c,g){this.get(a);
this.get(c);var h;if(!this.deepScalar(g)||!this.check(g,a)||!this.check(g,c))return!1;if("string"===this.get(g))return a===c;if("object"===this.get(g)){for(h in g)if(!this.compare(a[h],c[h],g[h]))return!1;return!0}if("array"===this.get(g)){if(a.length!==c.length)return!1;var l=a.length;for(h=0;h<l;h++)if(!this.compare(a[h],c[h],g[0]))return!1;return!0}return!1},isValid:function(a){var c,g;if("string"===this.get(a)){a=a.replace(/^\?/,"").split(/\|/);for(g in a)if(0>r.indexOf(a[g])&&m[a[g]]===l)return!1;
return!0}if("object"===this.get(a)){for(c in a)if(!this.isValid(a[c]))return!1;return!0}return"array"===this.get(a)?1===a.length?this.isValid(a[0]):!1:!1}}}();var ca=D.utils,ba=D.struct,L={maxDepth:0,strict:!1,verbose:!1,displayTime:!1,shortcutPrefix:":",mergeRequests:!0,logDescriptions:!0,xhr:XMLHttpRequest,clone:!1};D.settings=function(a,t){if("string"===typeof a&&1===arguments.length)return L[a];var g="object"===typeof a&&1===arguments.length?a||{}:{};"string"===typeof a&&(g[a]=t);for(var r in g)g[r]!==
l?L[r]=g[r]:delete L[r];return this};D.instances=function(a){if(arguments.length)return da[a];E("[domino.global] You need to indicate a name to get the instance.")};D.EventDispatcher=function(){Object.defineProperty(this,"_handlers",{value:{}})};var K=D.EventDispatcher;K.prototype.addEventListener=function(a,l){if(arguments.length)if(1===arguments.length&&"object"===ca.type.get(arguments[0]))for(a in arguments[0])this.addEventListener(a,arguments[0][a]);else if(1<arguments.length){var g;a=arguments[0];
l=arguments[1];var r=ca.array(a),m;for(m in r)g=r[m],this._handlers[g]||(this._handlers[g]=[]),this._handlers[g].push({handler:l})}return this};K.prototype.removeEventListener=function(a,l){var g,r,m,q,h=ca.array(a);if(!arguments.length){for(g in this._handlers)delete this._handlers[g];return this}if(l)for(g in h){q=h[g];if(this._handlers[q]){m=[];for(r in this._handlers[q])this._handlers[q][r].handler!==l&&m.push(this._handlers[q][r]);this._handlers[q]=m}this._handlers[q]&&0===this._handlers[q].length&&
delete this._handlers[q]}else for(g in h)delete this._handlers[h[g]];return this};K.prototype.dispatchEvent=function(a,t){var g,r,m,q,h,d=ca.array(a);t=t===l?{}:t;for(g in d)if(h=d[g],this._handlers[h]){q=this.getEvent(h,t);m=[];for(r in this._handlers[h])this._handlers[h][r].handler(q),this._handlers[h][r].one||m.push(this._handlers[h][r]);this._handlers[h]=m}return this};K.prototype.getEvent=function(a,l){return{type:a,data:l||{},target:this}};D.module=function(){K.call(this);for(var a in K.prototype)this[a]=
K.prototype[a];this.triggers={properties:{},events:{}}}}).call(this);
