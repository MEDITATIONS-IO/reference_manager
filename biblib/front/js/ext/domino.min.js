/* domino.js - a JS fast dashboard prototyping framework - Version: 1.2.3 - Author:  Alexis Jacomy, Linkfluence - License: MIT */
(function($,f){function ga(){S.strict?F.apply(this,arguments):ka.apply(this,arguments)}function F(){var a="",f;for(f in arguments)a+=(a?" ":"")+arguments[f];throw Error(a);}function ka(){S.verbose&&la.apply(this,arguments)}function la(){var a=[],f;for(f in arguments)a.push(arguments[f]);S.displayTime&&a.unshift(("00000000"+((new Date).getTime()-ta)).substr(-8));console&&console.log instanceof Function&&console.log.apply(console,a)}var sa=/^[a-zA-Z_$-][a-zA-Z_$0-9-]*$/,ta=new Date,aa={};if($.domino)throw Error("domino already exists");
$.domino=function(a,q){function m(b){b=b||{};var g={getEvents:Z,getLabel:ua,expand:X,warn:x,log:G,die:u,get:z};b.full?(g.kill=ga,g.update=c,g.request=Y,g.settings=B,g.addModule=e,g.killModule=d,g.getEvent=function(){C.getEvent.apply(C,arguments)},g.addEventListener=function(){C.addEventListener.apply(C,arguments)},g.removeEventListener=function(){C.removeEventListener.apply(C,arguments)},g.configuration=$,g.dispatchEvent=function(b,g){N({events:C.getEvent(b,g)});return this}):(b.request&&(Object.defineProperty(g,
"_services",{value:[]}),g.request=function(b,g){var a,h;if(p.check("string",b)){h={service:b};for(a in g||{})h[a]=g[a];this._services.push(h)}else if(p.check("object",b))this._services.push(b);else if(p.check("array",b))for(a in b)this._services.push(b[a]);return this}),b.dispatchEvent&&(Object.defineProperty(g,"_events",{value:[]}),g.dispatchEvent=function(b,g){this._events.push({type:b,data:g});return this}),b.update&&(Object.defineProperty(g,"_properties",{value:[]}),g.update=function(b,g){if("object"===
typeof b)for(var a in b)this._properties.push({property:a,value:b[a]});else"string"===typeof b&&1<arguments.length&&this._properties.push({property:b,value:g});return this}));return g}function s(b){b.request!==f&&(b.request=function(){u("This method is no longer available.");return this});b.dispatchEvent!==f&&(b.dispatchEvent=function(){u("This method is no longer available.");return this})}function n(b,g){var l,r,a=g||{};b===f&&u("Property name not specified");"string"!==p.get(b)&&u("The property name must be a string");
T[b]!==f&&u('Property "'+b+'" already exists');ha[b]!==f&&u('"'+b+'" can not be used to name a property');b.match(sa)||u("Property name not valid ("+sa+")");ma[b]={};for(r in a)ma[b][r]=a[r];na[b]=a.label||b;a.type!==f&&(p.isValid(a.type)?U[b]=a.type:x('Property "'+b+'": Type not valid'));a.setter!==f&&("function"!==p.get(a.setter)?x('Property "'+b+'": Setter is not a function'):(I[b]=a.setter,oa[b]=!0));I[b]=I[b]||function(g){if(p.deepScalar(U[b])&&p.compare(g,T[b],U[b]))return!1;U[b]&&!p.check(U[b],
g)?x('Property "'+b+'": Wrong type error'):T[b]=g;return!0};a.getter!==f&&("function"!==p.get(a.getter)?x('Property "'+b+'": Getter is not a function'):(J[b]=a.getter,pa[b]=!0));J[b]=J[b]||function(){return T[b]};if(a.value!==f||U[b])a.value!==f?ba(b,a.value):G('Property "'+b+'": Initial value is missing');if(a.triggers!==f)for(l in!p.check("array|string",a.triggers)&&x('Property "'+b+'": Events ("triggers") must be specified in an array or separated by spaces in a string'),V[b]=A.array(a.triggers),
V[b]||[])W[V[b][l]]=W[V[b][l]]||[],W[V[b][l]].push(b);a.dispatch!==f&&(p.check("array|string",a.dispatch)?ca[b]=A.array(a.dispatch):x('Property "'+b+'": Events ("dispatch") must be specified in an array or separated by spaces in a string'));return C}function v(b){var g=b||{};g.id!==f&&"string"===p.get(g.id)||u("The service id is not indicated.");p.check("function|string",g.url)||u("The service URL is not valid.");da[g.id]!==f&&u('The service "'+g.id+'" already exists.');da[g.id]=function(b){G('Calling service "'+
g.id+'".');var a=b||{},d=a.shortcuts||{},h={contentType:a.contentType||g.contentType,dataType:a.dataType||g.dataType,type:(a.type||g.type||"GET").toString().toUpperCase(),data:a.data!==f?a.data:"function"===p.get(g.data)?g.data.call(m(),a):g.data,url:"function"===p.get(g.url)?g.url.call(m(),a):g.url,error:function(b,l){C.dispatchEvent("domino.ajaxFailed");var h=a.error||g.error;G('Loading service "'+g.id+'" failed with message "'+b+'" and status '+l.status+".");"function"===p.get(h)&&D(h,{parameters:[b,
l,a],loop:a.loop||N,scope:{request:!0,dispatchEvent:!0,update:!0}})}},k,w,c;w=B("shortcutPrefix");b=RegExp(w+"(\\w+)","g");var e=RegExp("^"+w+"(\\w+)$"),q=null,n;for("string"!==p.get(h.url)&&u('The URL is no more a string (typed "'+p.get(h.url)+'")');(n=h.url.match(b))&&h.url!==q;)for(k in q=h.url,n)w=X(n[k].match(e)[1],d),h.url=h.url.replace(RegExp(n[k],"g"),w);k=!0;"string"===p.get(h.data)&&h.data.match(e)&&(h.data=X(h.data.match(e)[1],d));if("object"===p.get(h.data))for(;k;)for(c in k=!1,h.data)"string"===
p.get(h.data[c])&&h.data[c].match(e)&&(h.data[c]=X(h.data[c].match(e)[1],d),k=!0);h.success=function(b){var l,k,w,n,q={},qa=[],u=[],v={},z=!1,t=a.path||g.path,u=a.setter||g.setter,ba=a.success||g.success;n=a.expect||g.expect||B("expect");if("function"!==p.get(n)||n.call(m(),b,a,g)){G('Service "'+g.id+'" successfull.');"string"===p.get(u)&&u.match(e)&&(u=X(u.match(e)[1],d));"string"===p.get(t)&&t.match(e)&&(t=X(t.match(e)[1],d));n=b;(t||"").match(/^(?:\w+\.)*\w+$/)?k=p.get(t,"string")?t.split("."):
f:"string"===p.get(t)&&x('Path "'+t+'" does not match RegExp /^(?:\\w+\\.)*\\w+$/');if(k)for(l in k)n=n[k[l]],n===f&&x('Wrong path "'+t+'" for service "'+g.id+'".');k=A.array(g.events);for(l in k)q[k[l]]=1,z=!0;k=A.array(a.events);for(l in k)q[k[l]]=1,z=!0;u&&I[u]&&n!==f&&(v[u]=n,z=!0);if("function"===p.get(ba)){b=D(ba,{parameters:[b,a],scope:{request:!0,dispatchEvent:!0,update:!0}});k=A.array(b.events);for(c in k)z=!0,q[k[c].type]=1;for(c in b.update)v[c]===f?(v[c]=b.update[c],z=!0):x('The key "'+
c+'" is nor a method neither a property.');(b.services||[]).length&&(z=!0,qa=qa.concat(b.services));s(b)}u=[];for(w in q)u.push(C.getEvent(w));z&&(a.loop||N)({events:u,update:v,services:qa})}else G('"expect" test failed for service "'+g.id+'".'),h.error.call(this,"Unexpected data received.",this.xhr())};k=a.before||g.before;null!=k&&"function"===p.get(k)&&D(k,{parameters:[a],loop:!0,scope:{dispatchEvent:!0,update:!0}});a.abort&&ia[g.id]&&ia[g.id].abort();ia[g.id]=A.ajax(h)};return C}function e(b,
g,a){var r;a={};var d={},h,k;b===f&&u("Module class not specified.");"function"!==p.get(b)&&u("First parameter must be a function.");b.apply(a,(g||[]).concat(m()));b=a.triggers||{};for(k in b.events||{})O[k]=O[k]||[],O[k].push(b.events[k]);for(h in b.properties||{}){for(r in ca[h]||[])P[h]=P[h]||[],P[h].push(b.properties[h]);J[h]!==f&&(z(h),D(b.properties[h],{parameters:[m()]}))}for(k in W||{})d[k]=1;for(k in K||{})d[k]=1;for(k in L||{})d[k]=1;for(k in Q||{})d[k]=1;for(k in d)a.addEventListener(k,
w);R.push(a);return a}function d(b){var g,a,r,d,h,k,c,f={};if(0>R.indexOf(b))return C.warn("The module you try to kill is actually not referenced."),b;c=b.triggers||{};for(h in c.events){r=O[h];d=c.events[h];if(r&&r.length)for(g=0,a=r.length;g<a;g++)r[g]===d&&r.splice(g,1);r&&!r.length&&delete O[h]}for(k in c.properties){r=P[k];d=c.properties[k];if(r&&r.length)for(g=0,a=r.length;g<a;g++)r[g]===d&&r.splice(g,1);r&&!r.length&&delete P[k]}for(h in W||{})f[h]=1;for(h in K||{})f[h]=1;for(h in L||{})f[h]=
1;for(h in Q||{})f[h]=1;for(h in f)b.removeEventListener(h,w);R.splice(R.indexOf(b),1);return b}function c(b,g){var a="object"===typeof b&&1===arguments.length?b||{}:{};"string"===typeof b&&(a[b]=g);N({update:a});return this}function w(b){N({events:[b],emitter:b.target})}function N(b){var a,l,r,d,h,k,c,w=!1,e=[],n=[],q=[];b=b||{};var p={},t={};b.loop=(+b.loop||0)+1;b.loopId=b.loopId||++ka;B("maxDepth")&&b.loop>B("maxDepth")&&u("Loop "+b.loopId+" exceeds maximum depth ("+B("maxDepth")+")");var z=A.array(b.events);
c=A.array(b.services);var v=b.update||{};if(B("verbose")){G("Iteration "+b.loop+" (loop "+b.loopId+")");if(z.length){h=[];for(l in z)h.push(z[l].type);G(" -> Events: ",h)}if(c.length){h=[];for(l in c)h.push("string"===typeof c[l]?c[l]:c[l].service);G(" -> Services: ",h)}h=[];for(l in v)h.push(l);h.length&&G(" -> Update: ",h)}for(a in v)if(I[a]===f)x('The property "'+a+'" is not referenced.');else if(h=ba(a,v[a])||!!b.force){for(l in P[a])D(P[a][l],{parameters:[m(),{property:a,emitter:b.emitter}]});
for(l in ca[a]||[])h=ca[a][l],p[h]=C.getEvent(h)}if(c.length)if(B("mergeRequests"))Y(c);else for(r in c)Y(c[r]);for(l in z){k=z[l];for(r in c=k.data||{},a=W[k.type]||[],a)c[a[r]]!==f&&(w=!0,t[a[r]]=c[a[r]]);for(d in O[k.type])D(O[k.type][d],{parameters:[m(),k,b.emitter]});for(r in K[k.type]||[])if(0>e.indexOf(K[k.type][r])){e.push(K[k.type][r]);c=D(K[k.type][r],{parameters:[k],scope:{request:!0,dispatchEvent:!0,update:!0}});a=A.array(c.events);for(d in a)p[a[d].type]=a[d];for(d in c.update)t[d]===
f?(w=!0,t[d]=c.update[d]):x('The property "'+d+'" has already been updated in the current loop.');(c.services||[]).length&&(w=!0,q=q.concat(c.services));s(c)}for(r in L[k.type]||[])h=L[k.type][r],p[h]=C.getEvent(h);if(B("logDescriptions"))for(r in Q[k.type]||[])G("[HACK]",Q[k.type][r])}for(k in p)C.dispatchEvent(k,p[k].data),n.push(p[k]),w=!0;w&&N({events:n,update:t,services:q,emitter:b.emitter,loopId:b.loopId,loop:b.loop})}function z(b){if(J[b]){if(pa[b]){for(var a=[],l={},d=1,c=arguments.length;d<
c;d++)a.push(arguments[d]);l[b]=T[b];a=D(J[b],{parameters:a,inputValues:l});return M(b)?A.clone(a.returned):a.returned}return M(b)?A.clone(J[b]()):J[b]()}x('Property "'+b+'" not referenced.')}function ba(b,a){if(I[b]){if(oa[b]){var l,d;l=[];d={};M(b)&&(a=A.clone(a));d[b]=z(b);for(var c=1,h=arguments.length;c<h;c++)l.push(arguments[c]);d=D(I[b],{parameters:l,inputValues:d});(l="boolean"!==p.get(d.returned)||d.returned)&&(T[b]=d.update[b]);return l}return I[b].call(m(),M(b)?A.clone(a):a)}x('Property "'+
b+'" not referenced.');return!1}function Y(b,a){if(p.check("string",b))if(da[b])da[b](a);else x('Service "'+b+'" not referenced.');else if(p.check("object",b))Y(b.service,b);else if(p.check("array",b)){a=a||{};var l,d=b.length;if(a.merge!==f?a.merge:B("mergeRequests")){var c,h,k=d,w=[];for(l=0;l<d;l++){if("string"===typeof b[l])c={service:b[l]};else for(h in c={},b[l])c[h]=b[l][h];(function(b){c.loop=function(a){w[b]=a;if(!--k){var g,l,c={update:{},events:[],services:[]};for(g=0;g<d;g++){a=w[g]||
{};for(l in a.update||{})c.update[l]=a.update[l];c.events=c.events.concat(a.events||[]);c.services=c.services.concat(a.services||[])}N(c)}}})(l);Y(c)}}else for(l=0,d=b.length;l<d;l++)Y(b[l])}return this}function D(b,a){var l,d,c={},h=a||{},k=m(h.scope);"function"!==p.get(b)&&u("The first parameter must be a function");for(l in h.inputValues||{})k[l]=h.inputValues[l];d={returned:b.apply(k,h.parameters||[]),update:{},events:[],services:[]};null==k._events||p.check("array",k._events)?d.events=k._events:
x("Events must be stored in an array.");for(l in k)c[l]=k[l];for(l in k._properties)c[k._properties[l].property]=k._properties[l].value;for(l in c)I[l]!==f?d.update[l]=c[l]:ha[l]===f&&x('The key "'+l+'" is not a method nor a property.');for(l in h.inputValues)d.update[l]=k[l];for(l in k._services)d.services[l]=k._services[l];if(h.loop){c=(d.services||[]).length||(d.events||[]).length;if(!c)for(l in d.update)c=!0;c&&(p.check("function",h.loop)?h.loop:N)(d)}else return d}function ua(b){return na[b]}
function Z(b){return V[b]}function X(b){var a=b,d=(b||"").toString().match(RegExp("^"+B("shortcutPrefix")+"(\\w+)$"));d&&d.length&&(x("Prefix in expand() calls is deprecated."),a=d[1]);for(var d=1,c=arguments.length;d<c;d++)if((arguments[d]||{})[a]!==f)return arguments[d][a];if("function"===p.get(J[a]))return z(a);if("function"===p.get(ea[a]))return ea[a].call(m());x('The shortcut "',a,'" has not been recognized.');return a}function M(b){b=(ma[b]||{}).clone;return b!==f?!!b:B("clone")}function $(b){return arguments.length?
A.clone(ra[b]):A.clone(ra)}function ga(){var b;G('Killing instance "'+H+'"');for(b in R)R[b].removeEventListener();ea=ia=da=L=K=P=O=ca=W=R=oa=pa=T=I=J=V=na=U=R=null;for(b in fa)delete fa[b];aa[H]&&delete aa[H]}function B(b,a){if("string"===typeof b&&1===arguments.length)return ja[b]!==f?ja[b]:S[b];var d="object"===typeof b&&1===arguments.length?b||{}:{};"string"===typeof b&&(d[b]=a);for(var c in d)d[c]!==f?ja[c]=d[c]:delete ja[c];return this}function x(){var b=["["+(H||"domino")+"]"];B("strict")||
b.push("WARNING");for(var a in arguments)b.push(arguments[a]);B("strict")?F.apply(this,b):B("verbose")&&la.apply(this,b)}function u(){var b=["["+(H||"domino")+"]"],a;for(a in arguments)b.push(arguments[a]);F.apply(this,b)}function G(){var b=["["+(H||"domino")+"]"];if(B("verbose")){for(var a in arguments)b.push(arguments[a]);la.apply(this,b)}}(function(){y.call(this);for(var b in y.prototype)this[b]=y.prototype[b]}).call(this);var C=this,A=E.utils,p=E.struct,ja={},fa,ra,U={},na={},V={},J={},I={},T=
{},ma={},pa={},oa={},R=[],ka=0,W={},ca={},O={},P={},K={},L={},Q={},da={},ia={},ea={},ha={events:1,services:1,hacks:1};(function(){for(var b in Object.prototype)ha[b]=1;for(b in m({full:!0}))ha[b]=1})();fa=m({full:!0});var t={},H;"string"===p.get(a)?(t=q,t.name=a):a!==f&&"object"===p.get(a)?t=a:q!==f&&"object"===p.get(q)&&(t=q);t.name=H||t.name;(H=t.name)&&(aa[H]?u('An instance named "'+H+'" is already running.'):aa[H]=fa);(function(){for(var b in t.properties||[])n(t.properties[b].id,t.properties[b]);
for(b in t.hacks||[]){var a=void 0,d=void 0,c=t.hacks[b]||{};c.triggers===f&&u("A hack requires at least one trigger to be bound");a=A.array(c.triggers);for(d in a)Q[a[d]]=Q[a[d]]||[],L[a[d]]=L[a[d]]||[],K[a[d]]=K[a[d]]||[],c.description&&(Q[a[d]]=Q[a[d]].concat(c.description)),c.method&&K[a[d]].push(c.method),c.dispatch&&(L[a[d]]=L[a[d]].concat(A.array(c.dispatch)))}for(b in t.services||[])v(t.services[b]);for(b in t.shortcuts||[])a=t.shortcuts[b].id,d=t.shortcuts[b].method,a===f&&u("Shortcut ID not specified."),
ea[a]&&u('Shortcut "'+a+'" already exists.'),d===f&&u("Shortcut method not specified."),ea[a]=d})();ra=A.clone(t);return fa};var E=$.domino;E.utils={array:function(a,f){var m="string"===E.struct.get(a)?a.split(f||" "):"array"===E.struct.get(a)?a:[a],s=[],n;for(n in m)m[n]&&s.push(m[n]);return s},clone:function(a){if(!a)return a;var f,m;if("array"===Z.get(a))for(m in f=[],a)f[m]=this.clone(a[m]);else if("date"===Z.get(a))f=new Date(a.getTime());else if("object"===Z.get(a))if(a.prototype)f=a;else{f=
{};for(var s in a)f[s]=this.clone(a[s])}else f=a;return f},ajax:function(a,f){"string"===typeof a?a={url:a,ok:f}:"object"!==Z.get(a)&&F("[domino.global] Invalid parameter given to AJAX");var m=a.type||"GET",s=a.url||"",n=a.contentType||"application/x-www-form-urlencoded",v=a.dataType||"json",e=new XMLHttpRequest,d,c,w;if(a.data){if("string"===typeof a.data)c=a.data;else if(/json/.test(n))c=JSON.stringify(a.data);else{c=[];for(w in a.data)c.push(encodeURIComponent(w)+"="+encodeURIComponent(a.data[w]));
c=c.join("&")}/GET|DEL/i.test(m)&&(s+=/\?/.test(s)?"&"+c:"?"+c,c="")}e.onreadystatechange=function(){if(4==e.readyState)if(d&&clearTimeout(d),/^2/.test(e.status)){c=e.responseText;if(/json/.test(v))try{c=JSON.parse(e.responseText)}catch(f){return a.error&&a.error("JSON parse error: "+f.message,e)}a.success&&a.success(c,e)}else{var w=+e.status?e.responseText:e.responseText.length?"Aborted: "+e.responseText:"Aborted";a.error&&a.error(w,e)}};e.open(m,s,!0);e.setRequestHeader("Content-Type",n);if(a.headers)for(w in a.headers)e.setRequestHeader(w,
a.headers[w]);a.timeout&&(d=setTimeout(function(){e.onreadystatechange=function(){};e.abort();a.error&&a.error&&a.error("timeout",e)},1E3*a.timeout));e.send(c);return e}};E.struct=function(){var a=["number","string","boolean","null","undefined"],q="Boolean Number String Function Array Date RegExp Object".split(" "),m={},s=["*"],n={},v;for(v in q){var e=q[v];s.push(e.toLowerCase());m["[object "+e+"]"]=e.toLowerCase()}return{add:function(a,c,w){var e,m,q,v,D,y;1===arguments.length?"object"===this.get(a)?
(y=a,q=y.id,D=y.struct):F("[domino.global] If struct.add is called with one arguments, it has to be an object"):2===arguments.length?("string"===this.get(a)&&a?q=a:F("[domino.global] If struct.add is called with more than one arguments, the first one must be the string id"),D=c):F("[domino.global] struct.add has to be called with one or three arguments");"string"===this.get(q)&&0!==q.length||F("[domino.global] A structure requires an string id");n[q]!==f&&"proto"!==n[q]&&F('[domino.global] The structure "'+
q+'" already exists');n[q]=1;m=E.utils.array((y||{}).proto);v={};for(e in m)n[m[e]]===f&&(n[m[e]]=1,v[m[e]]=1);"function"===this.get(D)||this.isValid(D)||F('[domino.global] A structure requires a valid "structure" property describing the structure. It can be a valid structure or a function that test if an object matches the structure.');~s.indexOf(q)&&F('[domino.global] "'+q+'" is a reserved structure name');n[q]=y===f?{id:q,struct:D}:{};if(y!==f)for(e in y)n[q][e]=y[e];for(e in v)e!==q&&delete n[e]},
get:function(a){return null==a?String(a):m[Object.prototype.toString.call(a)]||"object"},check:function(a,c){var e,m,q=this.get(c);if("string"===this.get(a)){e=a.replace(/^\?/,"").split(/\|/);for(m in e)if(0>s.indexOf(e[m])&&n[e[m]]===f)return ga("[domino.global] Invalid type"),!1;if(null==c)return!!a.match(/^\?/,"");a.replace(/^\?/,"");for(m in e)if(n[e[m]]&&("function"===this.get(n[e[m]].struct)&&!0===n[e[m]].struct(c)||this.check(n[e[m]].struct,c)))return!0;return!(!~e.indexOf("*")&&!~e.indexOf(q))}if("object"===
this.get(a)){if("object"!==q)return!1;for(e in a)if(!this.check(a[e],c[e]))return!1;for(e in c)if(a[e]===f)return!1;return!0}if("array"===this.get(a)){if("array"!==q)return!1;if(1!==a.length)return ga("[domino.global] Invalid type"),!1;for(e in c)if(!this.check(a[0],c[e]))return!1;return!0}return!1},deepScalar:function(d){var c;if("string"===this.get(d)){d=d.replace(/^\?/,"").split(/\|/);for(c in d)if(0>a.indexOf(d[c]))return!1;return!0}if(this.check("object|array",d)){for(c in d)if(!this.deepScalar(d[c]))return!1;
return!0}return!1},compare:function(a,c,e){this.get(a);this.get(c);var f;if(!this.deepScalar(e)||!this.check(e,a)||!this.check(e,c))return!1;if("string"===this.get(e))return a===c;if("object"===this.get(e)){for(f in e)if(!this.compare(a[f],c[f],e[f]))return!1;return!0}if("array"===this.get(e)){if(a.length!==c.length)return!1;var m=a.length;for(f=0;f<m;f++)if(!this.compare(a[f],c[f],e[0]))return!1;return!0}return!1},isValid:function(a){var c,e;if("string"===this.get(a)){a=a.replace(/^\?/,"").split(/\|/);
for(e in a)if(0>s.indexOf(a[e])&&n[a[e]]===f)return!1;return!0}if("object"===this.get(a)){for(c in a)if(!this.isValid(a[c]))return!1;return!0}return"array"===this.get(a)?1===a.length?this.isValid(a[0]):!1:!1}}}();var M=E.utils,Z=E.struct,S={maxDepth:0,strict:!1,verbose:!1,displayTime:!1,shortcutPrefix:":",mergeRequests:!0,logDescriptions:!0,clone:!1};E.settings=function(a,q){if("string"===typeof a&&1===arguments.length)return S[a];var m="object"===typeof a&&1===arguments.length?a||{}:{};"string"===
typeof a&&(m[a]=q);for(var s in m)m[s]!==f?S[s]=m[s]:delete S[s];return this};E.instances=function(a){if(arguments.length)return aa[a];F("[domino.global] You need to indicate a name to get the instance.")};E.EventDispatcher=function(){Object.defineProperty(this,"_handlers",{value:{}})};var y=E.EventDispatcher;y.prototype.addEventListener=function(a,f){if(arguments.length)if(1===arguments.length&&"object"===M.type.get(arguments[0]))for(a in arguments[0])this.addEventListener(a,arguments[0][a]);else if(1<
arguments.length){var m;a=arguments[0];f=arguments[1];var s=M.array(a),n;for(n in s)m=s[n],this._handlers[m]||(this._handlers[m]=[]),this._handlers[m].push({handler:f})}return this};y.prototype.removeEventListener=function(a,f){var m,s,n,v,e=M.array(a);if(!arguments.length){for(m in this._handlers)delete this._handlers[m];return this}if(f)for(m in e){v=e[m];if(this._handlers[v]){n=[];for(s in this._handlers[v])this._handlers[v][s].handler!==f&&n.push(this._handlers[v][s]);this._handlers[v]=n}this._handlers[v]&&
0===this._handlers[v].length&&delete this._handlers[v]}else for(m in e)delete this._handlers[e[m]];return this};y.prototype.dispatchEvent=function(a,q){var m,s,n,v,e,d=M.array(a);q=q===f?{}:q;for(m in d)if(e=d[m],this._handlers[e]){v=this.getEvent(e,q);n=[];for(s in this._handlers[e])this._handlers[e][s].handler(v),this._handlers[e][s].one||n.push(this._handlers[e][s]);this._handlers[e]=n}return this};y.prototype.getEvent=function(a,f){return{type:a,data:f||{},target:this}};E.module=function(){y.call(this);
for(var a in y.prototype)this[a]=y.prototype[a];this.triggers={properties:{},events:{}}}})(window);
