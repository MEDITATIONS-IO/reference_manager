/* domino.js - a JS fast dashboard prototyping framework - Version: 1.2.4 - Author:  Alexis Jacomy, Linkfluence - License: MIT */
(function(da,g){function ka(){U.strict?D.apply(this,arguments):qa.apply(this,arguments)}function D(){var a="",g;for(g in arguments)a+=(a?" ":"")+arguments[g];throw Error(a);}function qa(){U.verbose&&ra.apply(this,arguments)}function ra(){var a=[],g;for(g in arguments)a.push(arguments[g]);U.displayTime&&a.unshift(("00000000"+((new Date).getTime()-Aa)).substr(-8));console&&console.log instanceof Function&&console.log.apply(console,a)}var xa=/^[a-zA-Z_$-][a-zA-Z_$0-9-]*$/,Aa=new Date,ea={};if(da.domino)throw Error("domino already exists");
da.domino=function(a,v){function l(b){b=b||{};var e={getEvents:ca,getLabel:ba,expand:Z,warn:y,log:E,die:w,get:la};b.full?(e.help=fa,e.kill=ka,e.update=p,e.request=K,e.settings=A,e.modules=d,e.addModule=h,e.killModule=c,e.getEvent=function(){B.getEvent.apply(B,arguments)},e.addEventListener=function(){B.addEventListener.apply(B,arguments)},e.removeEventListener=function(){B.removeEventListener.apply(B,arguments)},e.configuration=da,e.dispatchEvent=function(b,e){P({events:B.getEvent(b,e)});return this}):
(b.request&&(Object.defineProperty(e,"_services",{value:[]}),e.request=function(b,e){var f,a;if(n.check("string",b)){a={service:b};for(f in e||{})a[f]=e[f];this._services.push(a)}else if(n.check("object",b))this._services.push(b);else if(n.check("array",b))for(f in b)this._services.push(b[f]);return this}),b.dispatchEvent&&(Object.defineProperty(e,"_events",{value:[]}),e.dispatchEvent=function(b,e){this._events.push(B.getEvent(b,e));return this}),b.update&&(Object.defineProperty(e,"_properties",{value:[]}),
e.update=function(b,e){if("object"===typeof b)for(var f in b)this._properties.push({property:f,value:b[f]});else"string"===typeof b&&1<arguments.length&&this._properties.push({property:b,value:e});return this}));return e}function t(b){b.request!==g&&(b.request=function(){w("This method is no longer available.");return this});b.dispatchEvent!==g&&(b.dispatchEvent=function(){w("This method is no longer available.");return this})}function m(b,e){var q,x,f=e||{};b===g&&w("Property name not specified");
"string"!==n.get(b)&&w("The property name must be a string");Q[b]!==g&&w('Property "'+b+'" already exists');ma[b]!==g&&w('"'+b+'" can not be used to name a property');b.match(xa)||w("Property name not valid ("+xa+")");sa[b]={};for(x in f)sa[b][x]=f[x];ta[b]=f.label||b;f.description&&(L.properties[f.id]=f.description);f.type!==g&&(n.isValid(f.type)?V[b]=f.type:y('Property "'+b+'": Type not valid'));f.setter!==g&&("function"!==n.get(f.setter)?y('Property "'+b+'": Setter is not a function'):(G[b]=f.setter,
ua[b]=!0));G[b]=G[b]||function(e){if(n.deepScalar(V[b])&&n.compare(e,Q[b],V[b]))return!1;V[b]&&!n.check(V[b],e)?y('Property "'+b+'": Wrong type error'):Q[b]=e;return!0};f.getter!==g&&("function"!==n.get(f.getter)?y('Property "'+b+'": Getter is not a function'):(H[b]=f.getter,va[b]=!0));H[b]=H[b]||function(){return Q[b]};if(f.value!==g||V[b])f.value!==g?ya(b,f.value):E('Property "'+b+'": Initial value is missing');if(f.triggers!==g)for(q in!n.check("array|string",f.triggers)&&y('Property "'+b+'": Events ("triggers") must be specified in an array or separated by spaces in a string'),
W[b]=z.array(f.triggers),W[b]||[])X[W[b][q]]=X[W[b][q]]||[],X[W[b][q]].push(b);f.dispatch!==g&&(n.check("array|string",f.dispatch)?ga[b]=z.array(f.dispatch):y('Property "'+b+'": Events ("dispatch") must be specified in an array or separated by spaces in a string'));return B}function r(b){var e=b||{};e.id!==g&&"string"===n.get(e.id)||w("The service id is not indicated.");n.check("function|string",e.url)||w("The service URL is not valid.");$[e.id]!==g&&w('The service "'+e.id+'" already exists.');e.description&&
(L.services[e.id]=e.description);$[e.id]=function(b){E('Calling service "'+e.id+'".');var x=b||{},f=x.shortcuts||{},a={contentType:x.contentType||e.contentType,dataType:x.dataType||e.dataType,type:(x.type||e.type||"GET").toString().toUpperCase(),data:x.data!==g?x.data:"function"===n.get(e.data)?e.data.call(l(),x):e.data,url:"function"===n.get(e.url)?e.url.call(l(),x):e.url,error:function(b,q){B.dispatchEvent("domino.ajaxFailed");var a=x.error||e.error;E('Loading service "'+e.id+'" failed with message "'+
b+'" and status '+q.status+".");"function"===n.get(a)&&M(a,{parameters:[b,q,x],loop:x.loop||P,scope:{request:!0,dispatchEvent:!0,update:!0}})}},k,d,c;d=A("shortcutPrefix");b=RegExp(d+"(\\w+)","g");var h=RegExp("^"+d+"(\\w+)$"),s=null,p;for("string"!==n.get(a.url)&&w('The URL is no more a string (typed "'+n.get(a.url)+'")');(p=a.url.match(b))&&a.url!==s;)for(k in s=a.url,p)d=Z(p[k].match(h)[1],f),a.url=a.url.replace(RegExp(p[k],"g"),d);k=!0;"string"===n.get(a.data)&&a.data.match(h)&&(a.data=Z(a.data.match(h)[1],
f));if("object"===n.get(a.data))for(;k;)for(c in k=!1,a.data)"string"===n.get(a.data[c])&&a.data[c].match(h)&&(a.data[c]=Z(a.data[c].match(h)[1],f),k=!0);a.success=function(b,q){var k,d,na,s,p={},v=[],m=[],w={},r=!1,u=x.path||e.path,m=x.setter||e.setter,K=x.success||e.success;s=x.expect||e.expect||A("expect");if("function"!==n.get(s)||s.call(l(),b,x,e)){E('Service "'+e.id+'" successfull.');"string"===n.get(m)&&m.match(h)&&(m=Z(m.match(h)[1],f));"string"===n.get(u)&&u.match(h)&&(u=Z(u.match(h)[1],
f));s=b;(u||"").match(/^(?:\w+\.)*\w+$/)?d=n.get(u,"string")?u.split("."):g:"string"===n.get(u)&&y('Path "'+u+'" does not match RegExp /^(?:\\w+\\.)*\\w+$/');if(d)for(k in d)s=s[d[k]],s===g&&y('Wrong path "'+u+'" for service "'+e.id+'".');d=z.array(e.events);for(k in d)p[d[k]]=1,r=!0;d=z.array(x.events);for(k in d)p[d[k]]=1,r=!0;m&&G[m]&&s!==g&&(w[m]=s,r=!0);if("function"===n.get(K)){k=M(K,{parameters:[b,x],scope:{request:!0,dispatchEvent:!0,update:!0}});d=z.array(k.events);for(c in d)r=!0,p[d[c].type]=
d[c];for(c in k.update)w[c]===g?(w[c]=k.update[c],r=!0):y('The key "'+c+'" is nor a method neither a property.');(k.services||[]).length&&(r=!0,v=v.concat(k.services));t(k)}m=[];console.log(p);for(na in p)m.push(1===p[na]?B.getEvent(na):p[na]);r&&(x.loop||P)({events:m,update:w,services:v})}else E('"expect" test failed for service "'+e.id+'".'),a.error.call(this,"Unexpected data received.",q)};k=x.before||e.before;null!=k&&"function"===n.get(k)&&M(k,{parameters:[x],loop:!0,scope:{dispatchEvent:!0,
update:!0}});x.abort&&oa[e.id]&&oa[e.id].abort();oa[e.id]=z.ajax(a)};return B}function h(b,e,q){var a;q=q||{};var f={},d={},k,c;b===g&&w("Module class not specified.");"function"!==n.get(b)&&w("First parameter must be a function.");"id"in q&&q.id in Y&&w('The module with id "'+q.id+'" already exists.');b.apply(f,(e||[]).concat(l()));b=f.triggers||{};for(c in b.events||{})R[c]=R[c]||[],R[c].push(b.events[c]);for(k in b.properties||{}){for(a in ga[k]||[])S[k]=S[k]||[],S[k].push(b.properties[k]);H[k]!==
g&&(la(k),M(b.properties[k],{parameters:[l()]}))}for(c in X||{})d[c]=1;for(c in I||{})d[c]=1;for(c in N||{})d[c]=1;for(c in O||{})d[c]=1;for(c in d)f.addEventListener(c,s);"id"in q&&(Y[q.id]=f);T.push(f);return f}function d(b){return Y[b]}function c(b){var e,q,a,f,d,k,c,g,p={};n.check("string",b)&&(b=Y[b]);if(0>T.indexOf(b))return B.warn("The module you try to kill is actually not referenced."),b;g=b.triggers||{};for(k in g.events){f=R[k];d=g.events[k];if(f&&f.length)for(e=0,q=f.length;e<q;e++)f[e]===
d&&f.splice(e,1);f&&!f.length&&delete R[k]}for(c in g.properties){f=S[c];d=g.properties[c];if(f&&f.length)for(e=0,q=f.length;e<q;e++)f[e]===d&&f.splice(e,1);f&&!f.length&&delete S[c]}for(k in X||{})p[k]=1;for(k in I||{})p[k]=1;for(k in N||{})p[k]=1;for(k in O||{})p[k]=1;for(k in p)b.removeEventListener(k,s);T.splice(T.indexOf(b),1);for(a in Y)if(Y[a]===b){delete Y[a];break}return b}function p(b,e){var q="object"===typeof b&&1===arguments.length?b||{}:{};"string"===typeof b&&(q[b]=e);P({update:q});
return this}function s(b){P({events:[b],emitter:b.target})}function P(b){var e,q,a,f,d,k,c,p=!1,s=[],h=[],m=[];b=b||{};var n={},v={};b.loop=(+b.loop||0)+1;b.loopId=b.loopId||++qa;A("maxDepth")&&b.loop>A("maxDepth")&&w("Loop "+b.loopId+" exceeds maximum depth ("+A("maxDepth")+")");var u=z.array(b.events);c=z.array(b.services);var r=b.update||{};if(A("verbose")){E("Iteration "+b.loop+" (loop "+b.loopId+")");if(u.length){d=[];for(q in u)d.push(u[q].type);E(" -> Events: ",d)}if(c.length){d=[];for(q in c)d.push("string"===
typeof c[q]?c[q]:c[q].service);E(" -> Services: ",d)}d=[];for(q in r)d.push(q);d.length&&E(" -> Update: ",d)}for(e in r)if(G[e]===g)y('The property "'+e+'" is not referenced.');else if(d=ya(e,r[e])||b.force||ha(e,"force")){for(q in S[e])M(S[e][q],{parameters:[l(),{property:e,emitter:b.emitter}]});for(q in ga[e]||[])d=ga[e][q],n[d]=B.getEvent(d)}if(c.length)if(A("mergeRequests"))K(c);else for(a in c)K(c[a]);for(q in u){k=u[q];c=k.data||{};e=X[k.type]||[];for(a in e)c[e[a]]!==g&&(p=!0,v[e[a]]=c[e[a]]);
for(f in R[k.type])M(R[k.type][f],{parameters:[l(),k,b.emitter]});for(a in I[k.type]||[])if(0>s.indexOf(I[k.type][a])){s.push(I[k.type][a]);c=M(I[k.type][a],{parameters:[k],scope:{request:!0,dispatchEvent:!0,update:!0}});e=z.array(c.events);for(f in e)n[e[f].type]=e[f];for(f in c.update)v[f]===g?(p=!0,v[f]=c.update[f]):y('The property "'+f+'" has already been updated in the current loop.');(c.services||[]).length&&(p=!0,m=m.concat(c.services));t(c)}for(a in N[k.type]||[])d=N[k.type][a],n[d]=B.getEvent(d);
if(A("logDescriptions"))for(a in O[k.type]||[])E("[HACK]",O[k.type][a])}for(k in n)B.dispatchEvent(k,n[k].data),h.push(n[k]),p=!0;p&&P({events:h,update:v,services:m,emitter:b.emitter,loopId:b.loopId,loop:b.loop})}function la(b){if(H[b]){if(va[b]){for(var e=[],a={},d=1,f=arguments.length;d<f;d++)e.push(arguments[d]);a[b]=Q[b];e=M(H[b],{parameters:e,inputValues:a});return ha(b,"clone")?z.clone(e.returned):e.returned}return ha(b,"clone")?z.clone(H[b]()):H[b]()}y('Property "'+b+'" not referenced.')}function ya(b,
e){if(G[b]){if(ua[b]){var a,d;a=[];d={};ha(b,"clone")&&(e=z.clone(e));d[b]=la(b);for(var f=1,c=arguments.length;f<c;f++)a.push(arguments[f]);d=M(G[b],{parameters:a,inputValues:d});(a="boolean"!==n.get(d.returned)||d.returned)&&(Q[b]=d.update[b]);return a}return G[b].call(l(),ha(b,"clone")?z.clone(e):e)}y('Property "'+b+'" not referenced.');return!1}function K(b,e){if(n.check("string",b))if($[b])$[b](e);else y('Service "'+b+'" not referenced.');else if(n.check("object",b))K(b.service,b);else if(n.check("array",
b)){e=e||{};var a,d=b.length;if(e.merge!==g?e.merge:A("mergeRequests")){var f,c,k=d,p=[];for(a=0;a<d;a++){if("string"===typeof b[a])f={service:b[a]};else for(c in f={},b[a])f[c]=b[a][c];(function(b){f.loop=function(e){p[b]=e;if(!--k){var a,f,q={update:{},events:[],services:[]};for(a=0;a<d;a++){e=p[a]||{};for(f in e.update||{})q.update[f]=e.update[f];q.events=q.events.concat(e.events||[]);q.services=q.services.concat(e.services||[])}P(q)}}})(a);K(f)}}else for(a=0,d=b.length;a<d;a++)K(b[a])}return this}
function M(b,e){var a,d,f={},c=e||{},k=l(c.scope);"function"!==n.get(b)&&w("The first parameter must be a function");for(a in c.inputValues||{})k[a]=c.inputValues[a];d={returned:b.apply(k,c.parameters||[]),update:{},events:[],services:[]};null==k._events||n.check("array",k._events)?d.events=k._events:y("Events must be stored in an array.");for(a in k)f[a]=k[a];for(a in k._properties)f[k._properties[a].property]=k._properties[a].value;for(a in f)G[a]!==g?d.update[a]=f[a]:ma[a]===g&&y('The key "'+a+
'" is not a method nor a property.');for(a in c.inputValues)d.update[a]=k[a];for(a in k._services)d.services[a]=k._services[a];if(c.loop){f=(d.services||[]).length||(d.events||[]).length;if(!f)for(a in d.update)f=!0;f&&(n.check("function",c.loop)?c.loop:P)(d)}else return d}function ba(b){return ta[b]}function ca(b){return W[b]}function Z(b){var a=b,d=(b||"").toString().match(RegExp("^"+A("shortcutPrefix")+"(\\w+)$"));d&&d.length&&(y("Prefix in expand() calls is deprecated."),a=d[1]);for(var d=1,c=
arguments.length;d<c;d++)if((arguments[d]||{})[a]!==g)return arguments[d][a];if("function"===n.get(H[a]))return la(a);if("function"===n.get(aa[a]))return aa[a].call(l());y('The shortcut "',a,'" has not been recognized.');return a}function ha(b,a){var d=(sa[b]||{})[a];return d!==g?!!d:A(a)}function da(b){return arguments.length?z.clone(wa[b]):z.clone(wa)}function fa(b,a,d){var c,f={};switch(b){case "properties":if(1===arguments.length){for(c in Q)f[c]=L.properties[c]||"[no description is specified]";
return f}return L.properties[a]||"[no description is specified]";case "services":if(1===arguments.length){for(c in $)f[c]=L.services[c]||"[no description is specified]";return f}return L.services[a]||"[no description is specified]";case "shortcuts":if(1===arguments.length){for(c in aa)f[c]=L.shortcuts[c]||"[no description is specified]";return f}return L.shortcuts[a]||"[no description is specified]";case "hacks":if(1===arguments.length)return za;if(3===arguments.length)return f=[],"trigger"===a?f=
O[d]:"dispatch"===a&&(f=ia[d]),1===f.length?f[0]:f;case "full":return{properties:fa("properties"),shortcuts:fa("shortcuts"),services:fa("services"),hacks:fa("hacks")}}}function ka(){var b;E('Killing instance "'+F+'"');for(b in T)T[b].removeEventListener();aa=oa=$=N=I=S=R=ga=X=T=ua=va=Q=G=H=W=ta=V=T=null;for(b in ja)delete ja[b];ea[F]&&delete ea[F]}function A(b,a){if("string"===typeof b&&1===arguments.length)return pa[b]!==g?pa[b]:U[b];var d="object"===typeof b&&1===arguments.length?b||{}:{};"string"===
typeof b&&(d[b]=a);for(var c in d)d[c]!==g?pa[c]=d[c]:delete pa[c];return this}function y(){var b=["["+(F||"domino")+"]"];A("strict")||b.push("WARNING");for(var a in arguments)b.push(arguments[a]);A("strict")?D.apply(this,b):A("verbose")&&ra.apply(this,b)}function w(){var b=["["+(F||"domino")+"]"],a;for(a in arguments)b.push(arguments[a]);D.apply(this,b)}function E(){var b=["["+(F||"domino")+"]"];if(A("verbose")){for(var a in arguments)b.push(arguments[a]);ra.apply(this,b)}}(function(){J.call(this);
for(var b in J.prototype)this[b]=J.prototype[b]}).call(this);var B=this,z=C.utils,n=C.struct,pa={},ja,wa,V={},ta={},W={},H={},G={},Q={},sa={},va={},ua={},T=[],Y={},L={properties:{},shortcuts:{},services:{}},qa=0,X={},ga={},R={},S={},I={},N={},za=[],O={},ia={},$={},oa={},aa={},ma={events:1,services:1,hacks:1};(function(){for(var b in Object.prototype)ma[b]=1;for(b in l({full:!0}))ma[b]=1})();ja=l({full:!0});var u={},F;"string"===n.get(a)?(u=v,u.name=a):a!==g&&"object"===n.get(a)?u=a:v!==g&&"object"===
n.get(v)&&(u=v);u.name=F||u.name;(F=u.name)&&(ea[F]?w('An instance named "'+F+'" is already running.'):ea[F]=ja);(function(){for(var b in u.properties||[])m(u.properties[b].id,u.properties[b]);for(b in u.hacks||[]){var a=void 0,d=void 0,c=u.hacks[b]||{};c.triggers===g&&w("A hack requires at least one trigger to be bound");c.description&&za.push(c.description);a=z.array(c.triggers);for(d in a)O[a[d]]=O[a[d]]||[],N[a[d]]=N[a[d]]||[],I[a[d]]=I[a[d]]||[],c.description&&(O[a[d]]=O[a[d]].concat(c.description)),
c.method&&I[a[d]].push(c.method),c.dispatch&&(N[a[d]]=N[a[d]].concat(z.array(c.dispatch)));a=z.array(c.dispatch);for(d in a)ia[a[d]]=ia[a[d]]||[],c.description&&(ia[a[d]]=ia[a[d]].concat(c.description))}for(b in u.services||[])r(u.services[b]);for(b in u.shortcuts||[])a=u.shortcuts[b]||{},d=a.id,c=a.method,d===g&&w("Shortcut ID not specified."),aa[d]&&w('Shortcut "'+d+'" already exists.'),c===g&&w("Shortcut method not specified."),a.description&&(L.shortcuts[d]=a.description),aa[d]=c})();wa=z.clone(u);
return ja};var C=da.domino;C.utils={array:function(a,g){var l="string"===C.struct.get(a)?a.split(g||" "):"array"===C.struct.get(a)?a:[a],t=[],m;for(m in l)l[m]&&t.push(l[m]);return t},clone:function(a){if(!a)return a;var g,l;if("array"===ba.get(a))for(l in g=[],a)g[l]=this.clone(a[l]);else if("date"===ba.get(a))g=new Date(a.getTime());else if("object"===ba.get(a))if(a.prototype)g=a;else{g={};for(var t in a)g[t]=this.clone(a[t])}else g=a;return g},ajax:function(a,g){"string"===typeof a?a={url:a,ok:g}:
"object"!==ba.get(a)&&D("[domino.global] Invalid parameter given to AJAX");var l=a.type||"GET",t=a.url||"",m=a.contentType||"application/x-www-form-urlencoded",r=a.dataType||"json",h=new XMLHttpRequest,d,c,p;if(a.data){if("string"===typeof a.data)c=a.data;else if(/json/.test(m))c=JSON.stringify(a.data);else{c=[];for(p in a.data)c.push(encodeURIComponent(p)+"="+encodeURIComponent(a.data[p]));c=c.join("&")}/GET|DEL/i.test(l)&&(t+=/\?/.test(t)?"&"+c:"?"+c,c="")}h.onreadystatechange=function(){if(4==
h.readyState)if(d&&clearTimeout(d),/^2/.test(h.status)){c=h.responseText;if(/json/.test(r))try{c=JSON.parse(h.responseText)}catch(g){return a.error&&a.error("JSON parse error: "+g.message,h)}a.success&&a.success(c,h)}else{var p=+h.status?h.responseText:h.responseText.length?"Aborted: "+h.responseText:"Aborted";a.error&&a.error(p,h)}};h.open(l,t,!0);h.setRequestHeader("Content-Type",m);if(a.headers)for(p in a.headers)h.setRequestHeader(p,a.headers[p]);a.timeout&&(d=setTimeout(function(){h.onreadystatechange=
function(){};h.abort();a.error&&a.error&&a.error("timeout",h)},1E3*a.timeout));h.send(c);return h}};C.struct=function(){var a=["number","string","boolean","null","undefined"],v="Boolean Number String Function Array Date RegExp Object".split(" "),l={},t=["*"],m={},r;for(r in v){var h=v[r];t.push(h.toLowerCase());l["[object "+h+"]"]=h.toLowerCase()}return{add:function(a,c){var p,s,h,l,v,r;1===arguments.length?"object"===this.get(a)?(r=a,h=r.id,v=r.struct):D("[domino.global] If struct.add is called with one arguments, it has to be an object"):
2===arguments.length?("string"===this.get(a)&&a?h=a:D("[domino.global] If struct.add is called with more than one arguments, the first one must be the string id"),v=c):D("[domino.global] struct.add has to be called with one or three arguments");"string"===this.get(h)&&0!==h.length||D("[domino.global] A structure requires an string id");m[h]!==g&&"proto"!==m[h]&&D('[domino.global] The structure "'+h+'" already exists');m[h]=1;s=C.utils.array((r||{}).proto);l={};for(p in s)m[s[p]]===g&&(m[s[p]]=1,l[s[p]]=
1);"function"===this.get(v)||this.isValid(v)||D('[domino.global] A structure requires a valid "structure" property describing the structure. It can be a valid structure or a function that test if an object matches the structure.');~t.indexOf(h)&&D('[domino.global] "'+h+'" is a reserved structure name');m[h]=r===g?{id:h,struct:v}:{};if(r!==g)for(p in r)m[h][p]=r[p];for(p in l)p!==h&&delete m[p]},get:function(a){return null==a?String(a):l[Object.prototype.toString.call(a)]||"object"},check:function(a,
c,h){var s,l,r=this.get(c);h=h||{};if("string"===this.get(a)){s=a.replace(/^\?/,"").split(/\|/);for(l in s)if(0>t.indexOf(s[l])&&m[s[l]]===g)return ka("[domino.global] Invalid type"),!1;if(null==c)return!!a.match(/^\?/,"");a.replace(/^\?/,"");for(l in s)if(m[s[l]]&&("function"===this.get(m[s[l]].struct)?!0===m[s[l]].struct(c):this.check(m[s[l]].struct,c,m[s[l]])))return!0;return!(!~s.indexOf("*")&&!~s.indexOf(r))}if("object"===this.get(a)){if("object"!==r)return!1;for(s in a)if(!this.check(a[s],c[s]))return!1;
if(!h.includes)for(s in c)if(a[s]===g)return!1;return!0}if("array"===this.get(a)){if("array"!==r)return!1;if(1!==a.length)return ka("[domino.global] Invalid type"),!1;for(s in c)if(!this.check(a[0],c[s]))return!1;return!0}return!1},deepScalar:function(d){var c;if("string"===this.get(d)){d=d.replace(/^\?/,"").split(/\|/);for(c in d)if(0>a.indexOf(d[c]))return!1;return!0}if(this.check("object|array",d)){for(c in d)if(!this.deepScalar(d[c]))return!1;return!0}return!1},compare:function(a,c,g){this.get(a);
this.get(c);var h;if(!this.deepScalar(g)||!this.check(g,a)||!this.check(g,c))return!1;if("string"===this.get(g))return a===c;if("object"===this.get(g)){for(h in g)if(!this.compare(a[h],c[h],g[h]))return!1;return!0}if("array"===this.get(g)){if(a.length!==c.length)return!1;var l=a.length;for(h=0;h<l;h++)if(!this.compare(a[h],c[h],g[0]))return!1;return!0}return!1},isValid:function(a){var c,h;if("string"===this.get(a)){a=a.replace(/^\?/,"").split(/\|/);for(h in a)if(0>t.indexOf(a[h])&&m[a[h]]===g)return!1;
return!0}if("object"===this.get(a)){for(c in a)if(!this.isValid(a[c]))return!1;return!0}return"array"===this.get(a)?1===a.length?this.isValid(a[0]):!1:!1}}}();var ca=C.utils,ba=C.struct,U={maxDepth:0,strict:!1,verbose:!1,displayTime:!1,shortcutPrefix:":",mergeRequests:!0,logDescriptions:!0,clone:!1};C.settings=function(a,v){if("string"===typeof a&&1===arguments.length)return U[a];var l="object"===typeof a&&1===arguments.length?a||{}:{};"string"===typeof a&&(l[a]=v);for(var t in l)l[t]!==g?U[t]=l[t]:
delete U[t];return this};C.instances=function(a){if(arguments.length)return ea[a];D("[domino.global] You need to indicate a name to get the instance.")};C.EventDispatcher=function(){Object.defineProperty(this,"_handlers",{value:{}})};var J=C.EventDispatcher;J.prototype.addEventListener=function(a,g){if(arguments.length)if(1===arguments.length&&"object"===ca.type.get(arguments[0]))for(a in arguments[0])this.addEventListener(a,arguments[0][a]);else if(1<arguments.length){var l;a=arguments[0];g=arguments[1];
var t=ca.array(a),m;for(m in t)l=t[m],this._handlers[l]||(this._handlers[l]=[]),this._handlers[l].push({handler:g})}return this};J.prototype.removeEventListener=function(a,g){var l,t,m,r,h=ca.array(a);if(!arguments.length){for(l in this._handlers)delete this._handlers[l];return this}if(g)for(l in h){r=h[l];if(this._handlers[r]){m=[];for(t in this._handlers[r])this._handlers[r][t].handler!==g&&m.push(this._handlers[r][t]);this._handlers[r]=m}this._handlers[r]&&0===this._handlers[r].length&&delete this._handlers[r]}else for(l in h)delete this._handlers[h[l]];
return this};J.prototype.dispatchEvent=function(a,v){var l,t,m,r,h,d=ca.array(a);v=v===g?{}:v;for(l in d)if(h=d[l],this._handlers[h]){r=this.getEvent(h,v);m=[];for(t in this._handlers[h])this._handlers[h][t].handler(r),this._handlers[h][t].one||m.push(this._handlers[h][t]);this._handlers[h]=m}return this};J.prototype.getEvent=function(a,g){return{type:a,data:g||{},target:this}};C.module=function(){J.call(this);for(var a in J.prototype)this[a]=J.prototype[a];this.triggers={properties:{},events:{}}}})(window);
